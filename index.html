<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Mesh - A minimal, feature-rich speedcubing timer for tracking and improving your solves">
  <meta name="theme-color" content="#1a1a1a">
  <title>Mesh â€” Speedcubing Timer</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body data-theme="dark">
  <div class="app">
    <header class="header">
      <div class="header-left">
        <h1 class="logo">Mesh</h1>
        <div class="scramble-area">
          <div class="scramble-text" id="scrambleText"></div>
          <button class="btn-icon-small" id="copyScramble" title="Copy scramble">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
          </button>
          <button class="btn-icon-small" id="newScramble" title="New scramble">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M23 4v6h-6"></path>
              <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
            </svg>
          </button>
        </div>
      </div>
      <div class="header-right">
        <div class="header-controls">
          <label class="toggle-switch" title="Enable inspection time">
            <input type="checkbox" id="inspectionToggle">
            <span class="toggle-slider"></span>
            <span class="toggle-label">Inspection</span>
          </label>
          <label class="toggle-switch" title="Manual time entry mode">
            <input type="checkbox" id="typingModeToggle">
            <span class="toggle-slider"></span>
            <span class="toggle-label">Typing</span>
          </label>
        </div>
        <button class="btn-icon" id="themeToggle" title="Toggle theme">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-sun">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="icon-moon">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
        <button class="btn-icon" id="helpBtn" title="Keyboard shortcuts">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
        </button>
      </div>
    </header>

    <main class="main" id="mainArea">
      <div class="timer-container">
        <div class="timer-display" id="timerDisplay">0.00</div>
        <div class="timer-hint" id="timerHint">Press Space to start</div>

        <!-- Manual Time Input -->
        <div class="typing-input-container hidden" id="typingInputContainer">
          <input type="text" class="typing-input" id="typingInput" placeholder="Enter time (e.g., 12.34 or 1:23.45)" autocomplete="off">
          <button class="btn-primary btn-add-time" id="addTypedTime">Add Time</button>
        </div>
      </div>

      <div class="mesh-bar hidden" id="meshBar">
        <div class="mesh-track">
          <div class="mesh-segment cross" id="crossSegment">
            <span class="mesh-label">Cross</span>
            <span class="mesh-time" id="crossTime"></span>
          </div>
          <div class="mesh-divider" id="divider1" data-index="0"></div>
          <div class="mesh-segment f2l" id="f2lSegment">
            <span class="mesh-label">F2L</span>
            <span class="mesh-time" id="f2lTime"></span>
          </div>
          <div class="mesh-divider" id="divider2" data-index="1"></div>
          <div class="mesh-segment ll" id="llSegment">
            <span class="mesh-label">LL</span>
            <span class="mesh-time" id="llTime"></span>
          </div>
        </div>
        <p class="mesh-hint">Drag dividers to adjust split estimates</p>
      </div>
    </main>

    <footer class="footer">
      <div class="stats-container">
        <div class="stats">
          <div class="stat-item">
            <span class="stat-label">Ao5</span>
            <span class="stat-value" id="ao5">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Ao12</span>
            <span class="stat-value" id="ao12">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Ao50</span>
            <span class="stat-value" id="ao50">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Ao100</span>
            <span class="stat-value" id="ao100">-</span>
          </div>
          <div class="stat-item highlight">
            <span class="stat-label">Best</span>
            <span class="stat-value" id="best">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Worst</span>
            <span class="stat-value" id="worst">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Mean</span>
            <span class="stat-value" id="mean">-</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Count</span>
            <span class="stat-value" id="count">0</span>
          </div>
        </div>
      </div>

      <!-- Solve History -->
      <div class="solve-history" id="solveHistory">
        <div class="history-header">
          <span class="history-title">Recent Solves</span>
          <button class="btn-text" id="clearHistory">Clear All</button>
        </div>
        <div class="history-list" id="historyList"></div>
      </div>
    </footer>

    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h3>Sessions</h3>
        <button class="btn-icon" id="toggleSidebar" title="Close sidebar">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>

      <div class="session-controls">
        <select id="sessionType" class="session-type-select">
          <option value="normal">Normal</option>
          <option value="cross">Cross Practice</option>
          <option value="f2l">F2L Slow Practice</option>
          <option value="ll">Last Layer</option>
          <option value="one-handed">One-Handed</option>
          <option value="blind">Blind</option>
        </select>
        <button class="btn-new-session" id="newSession">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          New Session
        </button>
      </div>

      <div class="session-list" id="sessionList"></div>

      <div class="sidebar-section">
        <h4 class="sidebar-section-title">Data</h4>
        <div class="sidebar-actions">
          <button class="btn-secondary" id="exportData">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Export JSON
          </button>
          <button class="btn-secondary" id="importData">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            Import JSON
          </button>
          <input type="file" id="importFile" accept=".json" style="display:none">
        </div>
      </div>

      <div class="sidebar-section">
        <h4 class="sidebar-section-title">Tools</h4>
        <div class="sidebar-actions">
          <button class="btn-secondary" id="showSettings">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"></circle>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
            Settings
          </button>
          <button class="btn-secondary" id="showGoals">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <circle cx="12" cy="12" r="6"></circle>
              <circle cx="12" cy="12" r="2"></circle>
            </svg>
            Goal Mode
          </button>
          <button class="btn-secondary" id="showAnalytics">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="20" x2="18" y2="10"></line>
              <line x1="12" y1="20" x2="12" y2="4"></line>
              <line x1="6" y1="20" x2="6" y2="14"></line>
            </svg>
            Analytics
          </button>
        </div>
      </div>
    </aside>

    <button class="sidebar-toggle" id="sidebarToggle" title="Open sidebar">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </button>
  </div>

  <!-- Mesh Input Modal -->
  <div class="modal hidden" id="meshInputModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Solve Metrics</h3>
        <span class="modal-subtitle">Optional - track your efficiency</span>
      </div>
      <div class="metric-grid">
        <div class="metric-group">
          <label for="crossMoves">Cross Moves</label>
          <input type="number" id="crossMoves" min="0" max="99" placeholder="e.g., 8">
        </div>
        <div class="metric-group">
          <label for="crossRotations">Cross Rotations</label>
          <input type="number" id="crossRotations" min="0" max="3" placeholder="0-3">
        </div>
        <div class="metric-group">
          <label for="f2lRotations">F2L Rotations</label>
          <input type="number" id="f2lRotations" min="0" max="10" placeholder="0-6">
        </div>
      </div>
      <div class="metric-checkboxes">
        <label class="checkbox-label">
          <input type="checkbox" id="f2lPause">
          <span class="checkmark"></span>
          Major F2L Pause
        </label>
        <label class="checkbox-label">
          <input type="checkbox" id="llRecognition">
          <span class="checkmark"></span>
          LL Recognition Delay
        </label>
      </div>
      <div class="modal-actions">
        <button class="btn-secondary" id="skipMeshMetrics">Skip</button>
        <button class="btn-primary" id="saveMeshMetrics">Save Metrics</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal hidden" id="settingsModal">
    <div class="modal-content modal-wide">
      <div class="modal-header">
        <h3>Settings</h3>
      </div>
      <div class="settings-section">
        <h4>Timer</h4>
        <div class="settings-grid">
          <label class="checkbox-label">
            <input type="checkbox" id="settingMeshBar">
            <span class="checkmark"></span>
            Show Mesh Bar after solves
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="settingStackmat">
            <span class="checkmark"></span>
            Enable Stackmat (experimental)
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="settingHideWhileRunning">
            <span class="checkmark"></span>
            Hide time while running
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="settingVoiceAlerts">
            <span class="checkmark"></span>
            Voice alerts during inspection
          </label>
        </div>
      </div>
      <div class="settings-section">
        <h4>Display</h4>
        <div class="settings-grid">
          <label class="checkbox-label">
            <input type="checkbox" id="settingShowHistory">
            <span class="checkmark"></span>
            Show solve history below timer
          </label>
          <label class="checkbox-label">
            <input type="checkbox" id="settingConfirmDelete">
            <span class="checkmark"></span>
            Confirm before deleting solves
          </label>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-primary" id="closeSettings">Save & Close</button>
      </div>
    </div>
  </div>

  <!-- Goals Modal -->
  <div class="modal hidden" id="goalsModal">
    <div class="modal-content modal-wide">
      <div class="modal-header">
        <h3>Goal Mode</h3>
        <span class="modal-subtitle">Compare your performance against target benchmarks</span>
      </div>
      <div class="goal-selector">
        <label for="goalSelect">Select your target:</label>
        <select id="goalSelect" class="select-large">
          <option value="">No goal selected</option>
          <option value="sub60">Sub-60 (Beginner)</option>
          <option value="sub30">Sub-30 (Intermediate)</option>
          <option value="sub20">Sub-20</option>
          <option value="sub15">Sub-15</option>
          <option value="sub10">Sub-10</option>
          <option value="sub8">Sub-8</option>
          <option value="sub5">Sub-5</option>
          <option value="sub3">Sub-3 (World Class)</option>
        </select>
      </div>
      <div id="goalTable" class="goal-table"></div>
      <div class="modal-actions">
        <button class="btn-primary" id="closeGoals">Close</button>
      </div>
    </div>
  </div>

  <!-- Analytics Modal -->
  <div class="modal hidden" id="analyticsModal">
    <div class="modal-content modal-wide">
      <div class="modal-header">
        <h3>Analytics</h3>
        <span class="modal-subtitle">Session performance breakdown</span>
      </div>
      <div id="analyticsContent"></div>
      <div class="modal-actions">
        <button class="btn-primary" id="closeAnalytics">Close</button>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div class="modal hidden" id="helpModal">
    <div class="modal-content modal-wide">
      <div class="modal-header">
        <h3>Keyboard Shortcuts</h3>
      </div>
      <div class="shortcuts-grid">
        <div class="shortcut-item">
          <kbd>Space</kbd>
          <span>Start/Stop timer</span>
        </div>
        <div class="shortcut-item">
          <kbd>Esc</kbd>
          <span>Cancel current solve</span>
        </div>
        <div class="shortcut-item">
          <kbd>1</kbd>
          <span>Add +2 penalty to last solve</span>
        </div>
        <div class="shortcut-item">
          <kbd>2</kbd>
          <span>Mark last solve as DNF</span>
        </div>
        <div class="shortcut-item">
          <kbd>3</kbd>
          <span>Remove penalty from last solve</span>
        </div>
        <div class="shortcut-item">
          <kbd>Delete</kbd>
          <span>Delete last solve</span>
        </div>
        <div class="shortcut-item">
          <kbd>S</kbd>
          <span>Toggle sidebar</span>
        </div>
        <div class="shortcut-item">
          <kbd>I</kbd>
          <span>Toggle inspection mode</span>
        </div>
        <div class="shortcut-item">
          <kbd>T</kbd>
          <span>Toggle typing mode</span>
        </div>
        <div class="shortcut-item">
          <kbd>N</kbd>
          <span>Generate new scramble</span>
        </div>
        <div class="shortcut-item">
          <kbd>?</kbd>
          <span>Show this help</span>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-primary" id="closeHelp">Close</button>
      </div>
    </div>
  </div>

  <!-- Solve Edit Modal -->
  <div class="modal hidden" id="solveEditModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit Solve</h3>
      </div>
      <div class="solve-edit-content">
        <div class="solve-edit-time">
          <span id="editSolveTime"></span>
          <span id="editSolvePenalty" class="penalty-badge"></span>
        </div>
        <div class="solve-edit-scramble" id="editSolveScramble"></div>
        <div class="solve-edit-actions">
          <button class="btn-penalty" id="editPenaltyNone">OK</button>
          <button class="btn-penalty" id="editPenaltyPlus2">+2</button>
          <button class="btn-penalty" id="editPenaltyDNF">DNF</button>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-danger" id="deleteSolve">Delete Solve</button>
        <button class="btn-primary" id="closeEditSolve">Done</button>
      </div>
    </div>
  </div>

  <!-- Session Edit Modal -->
  <div class="modal hidden" id="sessionEditModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Edit Session</h3>
      </div>
      <div class="metric-group">
        <label for="sessionNameInput">Session Name</label>
        <input type="text" id="sessionNameInput" placeholder="Enter session name">
      </div>
      <div class="modal-actions">
        <button class="btn-danger" id="deleteSession">Delete Session</button>
        <button class="btn-primary" id="saveSessionEdit">Save</button>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div class="modal hidden" id="confirmModal">
    <div class="modal-content modal-small">
      <div class="modal-header">
        <h3 id="confirmTitle">Confirm</h3>
      </div>
      <p id="confirmMessage" class="confirm-message"></p>
      <div class="modal-actions">
        <button class="btn-secondary" id="confirmCancel">Cancel</button>
        <button class="btn-danger" id="confirmOk">Confirm</button>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div class="toast" id="toast">
    <span id="toastMessage"></span>
  </div>

  <script src="main.js"></script>
</body>
</html>
